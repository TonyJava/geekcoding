<div class="row-fluid">
	<div class="span12">
		{% set i = 1 %}
		{% for level in levels %}
		    <div class="lessonbox">
			<div class="row-fluid">
				<div class="span12">
					<blockquote>
						<div class="page-header">
							<div class="row-fluid">
								<div class="span12">
									<h4>{{ level.name }}</h4>
								</div>
							</div>
						</div>
					</blockquote>
				</div>
			</div>
			<a class="pane-control left" href="#openlesson{{i}}" data-slide="prev">&lsaquo;</a>
			<a class="pane-control right" href="#openlesson{{i}}" data-slide="next">&rsaquo;</a>
			<div id="openlesson{{i}}" class="carousel slide">
				<div class="carousel-inner">
					{% set length = 0 %}
                        {% for lesson in lessons %}
                          {# 获取当前类课程的数量 #}
                          {% if lesson.level == level %}{% set length = length+1  %}{% endif %}
                        {% endfor %}
                        {# 计算移动幻灯数量，这里术语为“步长” #}
                        {% if length % 3 == 0 %}{% set step = length / 3 %}{% else %}{% set step = length // 3 + 1 %}{% endif %}
                        {% set linum = 0 %}{# 此变量为已经遍历过的课程数据行，循环到下一页幻灯时，从linum条数据开始读取，即slice(linum) #}
                        {% for item in 1..step %}{# 从1开始到步长数step终止 #}
                        <div {% if item == 1 %} class="item active"{% else %} class="item"{% endif %}>
                          <ul class="thumbnails inibox">
                            {% set lisort = 0 %}{# lisort值即为当前课程块的排位，如果大于3即开始下一幻灯 #}
                            {% for lesson in lessons|slice(linum) if (lisort % 3 != 0 or lisort == 0) %}
                            {% if lesson.level == level %}
                            <li class="span4">
                              <div class="thumbnail">
                                <div class="videoico"></div>
                                  <img class="opimg" src="{{ asset(lesson.image) }}" alt="">    
                                <p>{{ lesson.name }}</p>
                              </div>
                            </li>
                            {% set lisort = lisort + 1 %}
                            {% endif %}
                            {% set linum = linum+1 %}
                            {% endfor %}
                          </ul>
                        </div>
                        {% endfor %}
				</div>
			</div>
		</div>
		{% if loop.index != levels|length %}
		<hr />
		{% endif %}
		{% set i = i+1 %}
		{% endfor %}
	</div>
</div>
